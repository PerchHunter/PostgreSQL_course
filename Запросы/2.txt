-- Найти решение с использованием временной таблицы 

CREATE TEMPORARY TABLE owner_metadata (
    owner_id INTEGER,
    owner_first_name VARCHAR(50),
    owner_last_name VARCHAR(50),
    owner_main_photo_url VARCHAR(250)
); 

INSERT INTO owner_metadata 
    SELECT 
        users.id,
        users.first_name,
        users.last_name,
        photo.url 
    FROM users
        JOIN photo
        ON photo.id = users.main_photo_id;

SELECT 
    video.id AS video_id,
    owner_first_name,
    owner_last_name,
    owner_main_photo_url,
    video.url AS video_url,
    video.size AS video_size
FROM video
    JOIN owner_metadata
    ON owner_metadata.owner_id = video.owner_id
ORDER BY video.size DESC
LIMIT 10;